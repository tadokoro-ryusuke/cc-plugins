# Security Rules

## 【CRITICAL】8 つの重大セキュリティチェック

### 1. 機密情報の保護

- API キー、シークレット、トークンをコードにハードコードしない
- `.env` ファイルを `.gitignore` に追加
- 機密情報を含むファイルをコミットしない

### 2. 入力検証

- ユーザー入力は常に信頼しない
- Zod/Yup でスキーマベースのバリデーション
- サーバーサイドでも必ず検証

### 3. SQL インジェクション対策

- Prisma/Drizzle などの ORM を使用
- 生の SQL クエリを避ける
- パラメータ化クエリを使用

### 4. XSS 対策

- React の自動エスケープを活用
- `dangerouslySetInnerHTML` を避ける
- ユーザー入力を HTML として出力しない

### 5. CSRF 対策

- トークンベースの認証を実装
- SameSite Cookie 属性を設定
- Origin ヘッダーを検証

### 6. 認証・認可

- セッション管理の適切な実装
- JWT の適切な有効期限設定
- 最小権限の原則

### 7. 依存関係のセキュリティ

- `npm audit` を定期実行
- 脆弱性のあるパッケージを更新
- 不要な依存関係を削除

### 8. エラーハンドリング

- 詳細なエラーメッセージを本番環境で露出しない
- スタックトレースをユーザーに表示しない
- 適切なエラーログを記録

## 金融システム向け追加チェック

- トランザクションの原子性を保証
- 監査ログの実装
- レート制限の実装
- ウォレット署名の検証（Web3）
